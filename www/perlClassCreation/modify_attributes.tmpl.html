<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<TMPL_INCLUDE NAME="header.tmpl.html">
 <script type="text/javascript">
var regularExpr ="sebastian";

function conseil(){
	var s = document.getElementById('typeDeVar');
	if(s.options[s.selectedIndex].value){

		var typeDeVar = s.options[s.selectedIndex].value;

		switch (typeDeVar){
			case "Any":
				document.getElementById("textDiv").innerHTML = "";
				regularExpr = /(.)*/;
				break;
			case "Str":
				document.getElementById("textDiv").innerHTML = "Ex : Some text";
				regularExpr = /^[A-Za-z0-9]{5,20}$/;
				break;
			case "Array":
				document.getElementById("textDiv").innerHTML = 'Ex: ( "An" , "array" , "with" , 5 , "elements" ) or (1 .. 10)';
				regularExpr = /^\(\s*("[A-Za-z0-9]+"|\d+)\s*(,\s*("[A-Za-z0-9]+"|\d+)\s*)*\)$/; <!-- /^\(("[A-Za-z0-9]+"|\d+)\)$/; /^\((\s*,\s*seba\s*)*\)$/ -->
				break;
			case "Hash":
				document.getElementById("textDiv").innerHTML = 'Ex: ( "seba" => 213)';
				regularExpr = /^\(\s*"[A-Za-z0-9]+"\s*=>\s*("[A-Za-z0-9]+"|\d+)\s*(,\s*"[A-Za-z0-9]+"\s*=>\s*("[A-Za-z0-9]+"|\d+)\s*)*\)$/; <!-- /^\(\s*"[A-Za-z0-9]+"\s*=>\s*"[A-Za-z0-9]+"|\d+)\s\)$/; -->
				break;
			case "Bool":
				document.getElementById("textDiv").innerHTML = "Ex: 0 or 1";
				regularExpr = /^(0|1)$/;
				break;
			case "Undef":
				document.getElementById("textDiv").innerHTML = "";
				
				break;
			case "Num":
				document.getElementById("textDiv").innerHTML = "Ex: 5.231423";
				regularExpr = /^[0-9]+([.][0-9]+)?$/;
				break;
			case "Int":
				document.getElementById("textDiv").innerHTML = "Ex: 5";
				regularExpr = /^[0-9]+$/;
				break;	
			case "ArreyRef":
				document.getElementById("textDiv").innerHTML = "Ex: [ 1, 2, [ 'a', 'b', 'c' ] ]";
				regularExpr = /^\[\s*("[A-Za-z0-9]+"|\d+)\s*(,\s*("[A-Za-z0-9]+"|\d+)\s*)*\]$/;
				break;
			case "HashRef":
				document.getElementById("textDiv").innerHTML = 'Ex: { "name" => "Harsha" , "designation" => "Manager" }'; <!--  'Adam' => 'Eve' , 'Clyde' => 'Bonnie' }"; -->
				regularExpr = /^{\s*"[A-Za-z0-9]+"\s*=>\s*("[A-Za-z0-9]+"|\d+)\s*(,\s*"[A-Za-z0-9]+"\s*=>\s*("[A-Za-z0-9]+"|\d+)\s*)*}$/; <!-- (,\s*"[A-Za-z0-9]+"\s*=>\s*("[A-Za-z0-9]+"|\d+)\s*)* -->
				break;
			default:
				document.getElementById("textDiv").innerHTML = typeDeVar;
				regularExpr = "Default";
		}
	}
};
function checkDefault(){
	var inputtt = document.getElementById("valeur_defaut").value;
	var re = regularExpr;

	if(!re.test(inputtt)){
		document.getElementById('valeur_defaut').style.color = 'red';
		alert("maremma sta roba funziona");
		document.getElementById("submit").disabled=true;
	}else{
		document.getElementById('valeur_defaut').style.color = 'green';	
		document.getElementById("submit").disabled=false;
	}
}; 
</script>


<div id="container">

<form name="modify_attr" method="post" action="links.cgi">

	<div id="add_attribut">
		<fieldset>Nom de l'Attribut :<br/>
			<input type='hidden' name='rm' value='mode13'>
			<input type='hidden' name='selected_attribut' value='<TMPL_VAR NAME="SELECTED_ATTRIBUT">'>
			<input type='text' name='attribut_name' id="attribut_name"/><br/><br/>
			
			Obligatoire :<br/>	
			Non	<input type='radio' name='obligatoire' value=0 checked="checked"/><br/>				
			Oui	<input type='radio' name='obligatoire' value=1 /><br/><br/>

			Type de Variable : 
			<select name = 'typeDeVar' id="typeDeVar" onchange = "conseil()">
				<optgroup label="common types"> 
					<OPTION value='Any'>Any</OPTION>
					<OPTION value='Str'>String</OPTION>
					<OPTION value='Array'>Array</OPTION>
					<OPTION value='Hash'>Hash</OPTION>
					<OPTION value='Bool'>Boolean</OPTION>
					<OPTION value='Undef'>Undefined</OPTION>
					<OPTION value='Num'>Numeric</OPTION>
					<OPTION value='Int'>Integers</OPTION>
				</optgroup>
				<optgroup label="references"> 
					<OPTION value='ScalarRef'>Reference to a scalar </OPTION>
					<OPTION value='ArreyRef'>Reference to a an array</OPTION>
					<OPTION value='HashRef'>Reference to a hash</OPTION>
					<!--
					<OPTION value=''></OPTION>
					<OPTION value=''></OPTION>
					-->
					</optgroup> 
			</select>
			<p>accés<br/> seulement en lecture: <input type='radio' name='access' value=0  /><br/>
				lecture et écriture: <input type='radio' name='access' value=1  />
			</p>
			
			Valeur par Défaut:<br/>
			<input type='text' name='valeur_defaut' id='valeur_defaut' onchange="checkDefault()" /><span id="textDiv"> </span><br/><br/>
			
			Trigger : <br/><textarea name="trigger" id="trigger" rows="4" cols="50"></textarea><br/><br/>
			<input type='submit' name='submit' value='enregistrer' id="submit">
			<input type='submit' name='cancel' value='cancel'>
		</fieldset> 
	</div>
</form>
</div> <!--ends container id-->

<script type="text/javascript">
function setSelectValue (id, val) {
    document.getElementById(id).value = val;
}

<TMPL_IF "HACHAGE_LOOP">
	<TMPL_LOOP NAME="HACHAGE_LOOP">
		document.getElementById('attribut_name').value = '<TMPL_VAR NAME="nom">';
		setSelectValue('typeDeVar', '<TMPL_VAR NAME="typeDeVar">');
		document.getElementById('valeur_defaut').value = '<TMPL_VAR NAME="val_defaut">';
		document.modify_attr.obligatoire[<TMPL_VAR NAME="necessaire">].checked = true;
		document.modify_attr.access[<TMPL_VAR NAME="ecriture">].checked = true;
		document.getElementById('trigger').value = '<TMPL_VAR NAME="declencheur">'; 
		
		<!-- var presetValue = '<TMPL_VAR NAME="necessaire">'
		<!--$("[name=obligatoire]").filter("[value='"+presetValue+"']").prop("checked",true); -->
	</TMPL_LOOP>
</TMPL_IF>

conseil();
checkDefault();
</script>
<TMPL_VAR NAME="SELECTED_ATTRIBUT"><br/>

<TMPL_VAR NAME="ATTRIBUTES_NAMES"><br/><br/><br/>
<TMPL_IF "HACHAGE_LOOP">
	<TMPL_LOOP NAME="HACHAGE_LOOP">
		Nom de l'attribut : <TMPL_VAR NAME="nom"><br/>
		lecture et ecriture : <TMPL_VAR NAME="ecriture"><br/>
		type de variable : <TMPL_VAR NAME="typeDeVar"><br/>
		necessaire : <TMPL_VAR NAME="necessaire"><br/>
		valeur par défaut : <TMPL_VAR NAME="val_defaut"><br/>
		Trigger : <TMPL_VAR NAME="declencheur"><br/>
		Parent : <TMPL_VAR NAME="parent"><br/>
	</TMPL_LOOP>
</TMPL_IF>

<TMPL_Include NAME="footer.tmpl.html">